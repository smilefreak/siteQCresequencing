{
    "contents" : "qc_m = read.table(\"merged_qc_new.txt\")\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(xtable)\n\n## Load databases\n\n\n\nfhet <- function(p) { 2*p*(1-p) }\n##### In cases 37 females and 193 males\n##### in controls 121 females and 86 males.\nfhetX = function(p) { 2*(p)*(1-p) * (158/(278+158))}\n\nget_tstv_total = function(){\n  tstv <- length( qc_table[ ( qc_table$genotype == \"A/G\" |  qc_table$genotype == \"G/A\" | \n                            qc_table$genotype == \"C/T\" | qc_table$genotype == \"T/C\" ), 1 ] )\n  return(tstv/(nrow(qc_table)-tstv))\n}\nget_tstv_included= function(included_sites){\n  n = sum(included_sites)\n  tstv <- length( qc_table[ ( qc_table$genotype == \"A/G\" |  qc_table$genotype == \"G/A\" | \n                                qc_table$genotype == \"C/T\" | qc_table$genotype == \"T/C\" ) & included_sites, 1 ] )\n  return(tstv/(n-tstv))\n}\nget_tstv_excluded = function(included_sites){\n  n = sum(!included_sites)\n  tstv <- length( qc_table[ ( qc_table$genotype == \"A/G\" |  qc_table$genotype == \"G/A\" | \n                                qc_table$genotype == \"C/T\" | qc_table$genotype == \"T/C\" ) & !included_sites, 1 ] )\n  return(tstv/(n-tstv))\n}\nqc_m = qc_m %>% mutate(HET =  ((qc_m$HETA + qc_m$HETU) / (qc_m$OBSA + qc_m$OBSU)) )\nqc_m = qc_m %>% mutate(MAF_2 = ((qc_m$MAC.cases +  qc_m$MAC.controls)/ ((qc_m$OBSA + qc_m$OBSU)*2)))\nqc_table = qc_m %>%\n  select(\n    pvalue = P,\n    genotype = REF.ALT,\n    variant = VAR,\n    MAF_cases = MAF.cases,\n    MAF_controls = MAF.controls,\n    HET_cases = HET.cases,\n    HET_controls = HET.controls,\n    GQ50_num = GQ50,\n    GQ10_num = GQ10,\n    count_cases = CNTA,\n    count_controls = CNTU,\n    hwe = HWE,\n    HET = SAMPLE_HET_AB,\n    MAF = MAF,\n    filter = FILTER.x,        \n    coverage_mean = DPM,\n    genotype_quality_mean =GQM,\n    proportion_hetAB_30_70=PROP_DEVIANT_HET_AB_30_70,\n    proportion_hetAB_20_80=PROP_DEVIANT_HET_AB_20_80,\n    altAB=SAMPLE_HOM_AB,\n    refAB=SAMPLE_REF_AB,\n    # Filter indivdual sites also\n    annotation = ANNOT,  \n    hwe_cases = HWE.cases,\n    hwe_controls = HWE.controls, \n    hetAB_cases = SAMPLE_HET_AB.cases,\n    hetAB_controls = SAMPLE_HET_AB.controls,\n    proportion_hetAB_30_70_cases = PROP_DEVIANT_HET_AB_30_70.cases,\n    proportion_hetAB_30_70_controls =PROP_DEVIANT_HET_AB_30_70.controls,\n    proportion_hetAB_20_80_controls = PROP_DEVIANT_HET_AB_20_80.controls,\n    proportion_hetAB_20_80_cases = PROP_DEVIANT_HET_AB_20_80.cases,\n    genotype_quality_mean_cases = GQM.cases,\n    genotype_qualtiy_mean_controls= GQM.controls,\n    coverage_mean_controls = DPM.controls,\n    coverage_mean_cases = DPM.cases,\n    refAB_cases = SAMPLE_REF_AB.cases,\n    refAB_controls = SAMPLE_REF_AB.controls,\n    altAB_cases = SAMPLE_HOM_AB.cases,\n    altAB_controls = SAMPLE_HOM_AB.controls,\n    filter = FILTER.x\n    )\n\nprint(nrow(qc_table))\nqc_table=qc_table[ !(qc_table$count_cases + qc_table$count_controls == 0),]\nprint(nrow(qc_table))\n\n\nn = nrow(qc_table)\n",
    "created" : 1423113176626.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2571923865",
    "id" : "6187381",
    "lastKnownWriteTime" : 1430346770,
    "path" : "~/resequencing/siteqc/global.R",
    "project_path" : "global.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}